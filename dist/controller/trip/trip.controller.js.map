{"version":3,"file":"trip.controller.js","sourceRoot":"","sources":["../../../src/controller/trip/trip.controller.ts"],"names":[],"mappings":";;;AAGA,6CAAuD;AAIvD,+CAAwC;AAExC,MAAM,cAAc;IAClB,KAAK,CAAC,UAAU,CAAC,GAAqB,EAAE,GAAa,EAAE,IAAkB;QACvE,MAAM,EAAC,GAAG,EAAC,GAAG,GAAG,CAAC,IAAqB,CAAC;QACxC,MAAM,IAAI,GAAG,GAAG,CAAC,IAAI,CAAC;QAEtB,MAAM,OAAO,GAAG,MAAM,sBAAW,CAAC,UAAU,CAAC,EAAC,GAAG,IAAI,EAAE,MAAM,EAAE,GAAG,EAAC,CAAC,CAAC;QAErE,MAAM,qBAAU,CAAC,SAAS,CAAC;YACzB,MAAM,EAAE,GAAG;YACX,KAAK,EAAE,mBAAO,CAAC,eAAe;YAC9B,IAAI,EAAE;gBACJ,MAAM,EAAE,OAAO,CAAC,GAAG;gBACnB,KAAK,EAAE,OAAO,CAAC,KAAK;aACrB;SACF,CAAC,CAAC;QAEH,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;IACpB,CAAC;IAAC,KAAK,CAAE,CAAC;QACR,IAAI,CAAC,CAAC,CAAC,CAAC;IACV,CAAC;CACA;AACF,CAAC;AAEW,QAAA,cAAc,GAAG,IAAI,cAAc,EAAE,CAAC","sourcesContent":["import {NextFunction, Response} from 'express';\r\nimport * as Joi from 'joi';\r\n\r\nimport {logService, tripService} from '../../services';\r\nimport {newTripValidator} from '../../validators';\r\nimport {UserInterface} from '../../models';\r\nimport {IExtentedRequest} from '../../models/extendRequest.interface';\r\nimport {LogEnum} from '../../constants';\r\n\r\nclass TripController {\r\n  async createTrip(req: IExtentedRequest, res: Response, next: NextFunction) {\r\n    const {_id} = req.user as UserInterface;\r\n    const trip = req.body;\r\n\r\n    const newTrip = await tripService.createTrip({...trip, userId: _id});\r\n\r\n    await logService.createLog({\r\n      userId: _id,\r\n      event: LogEnum.PRODUCT_CREATED,\r\n      data: {\r\n        tripId: newTrip._id,\r\n        title: newTrip.title\r\n      }\r\n    });\r\n\r\n    res.json(newTrip);\r\n  } catch (e) {\r\n    next(e);\r\n  }\r\n  }\r\n};\r\n\r\nexport const tripController = new TripController();\r\n"]}