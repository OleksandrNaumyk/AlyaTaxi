{"version":3,"file":"trip.controller.js","sourceRoot":"","sources":["../../../src/controller/trip/trip.controller.ts"],"names":[],"mappings":";;;AAEA,6CAAuD;AAEvD,+CAAwC;AAExC,MAAM,cAAc;IAClB,KAAK,CAAC,UAAU,CAAC,GAA6B,EAAE,GAAa,EAAE,IAAkB;QAE/E,IAAI;YACF,MAAM,EAAC,GAAG,EAAC,GAAG,GAAG,CAAC,IAAqB,CAAC;YACxC,MAAM,IAAI,GAAG,GAAG,CAAC,IAAI,CAAC;YAEtB,MAAM,OAAO,GAAG,MAAM,sBAAW,CAAC,UAAU,CAAC,EAAC,GAAG,IAAI,EAAE,MAAM,EAAE,GAAG,EAAC,CAAC,CAAC;YAErE,MAAM,qBAAU,CAAC,SAAS,CAAC;gBACzB,MAAM,EAAE,GAAG;gBACX,KAAK,EAAE,mBAAO,CAAC,YAAY;gBAC3B,IAAI,EAAE;oBACJ,MAAM,EAAE,OAAO,CAAC,GAAG;oBACnB,QAAQ,EAAE,OAAO,CAAC,QAAQ;iBAC3B;aACF,CAAC,CAAC;YAEH,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;SACnB;QACD,OAAO,CAAC,EAAE;YACR,IAAI,CAAC,CAAC,CAAC,CAAC;SACT;IACH,CAAC;CACF;AAEY,QAAA,cAAc,GAAG,IAAI,cAAc,EAAE,CAAC","sourcesContent":["import {NextFunction, Response} from 'express';\r\n\r\nimport {logService, tripService} from '../../services';\r\nimport {RequestExtendedInterface, UserInterface} from '../../models';\r\nimport {LogEnum} from '../../constants';\r\n\r\nclass TripController {\r\n  async createTrip(req: RequestExtendedInterface, res: Response, next: NextFunction) {\r\n\r\n    try {\r\n      const {_id} = req.user as UserInterface;\r\n      const trip = req.body;\r\n\r\n      const newTrip = await tripService.createTrip({...trip, userId: _id});\r\n\r\n      await logService.createLog({\r\n        userId: _id,\r\n        event: LogEnum.TRIP_CREATED,\r\n        data: {\r\n          tripId: newTrip._id,\r\n          driverId: newTrip.driverId\r\n        }\r\n      });\r\n\r\n      res.json(newTrip);\r\n    }\r\n    catch (e) {\r\n      next(e);\r\n    }\r\n  }\r\n}\r\n\r\nexport const tripController = new TripController();\r\n"]}