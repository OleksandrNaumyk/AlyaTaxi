{"version":3,"file":"auth.service.js","sourceRoot":"","sources":["../../../src/services/auth/auth.service.ts"],"names":[],"mappings":";;;AAAA,6CAAkD;AAGlD,MAAM,WAAW;IACf,eAAe,CAAC,WAA0C;QACxD,MAAM,cAAc,GAAG,IAAI,2BAAgB,CAAC,WAAW,CAAC,CAAC;QAEzD,OAAO,cAAc,CAAC,IAAI,EAAE,CAAC;IAC/B,CAAC;IAED,KAAK,CAAC,eAAe,CAAC,UAAyD;;QAC7E,MAAM,YAAY,GAAG,MAAM,2BAAgB;aACxC,OAAO,CAAC,UAAU,CAAC;aACnB,QAAQ,CAAC,QAAQ,CAAC;aAClB,MAAM,CAAC,EAAC,MAAM,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAC,CAAQ,CAAC;QAEtC,aAAO,YAAY,aAAZ,YAAY,uBAAZ,YAAY,CAAE,MAAM,0CAAE,MAAM,GAAG;IACxC,CAAC;IAED,WAAW,CAAC,YAA2D;QACrE,OAAO,2BAAgB,CAAC,gBAAgB,CAAC,YAAY,CAAQ,CAAC;IAChE,CAAC;CACF;AAEY,QAAA,WAAW,GAAG,IAAI,WAAW,EAAE,CAAC","sourcesContent":["import { AccessTokenModel } from '../../database';\r\nimport {AccessTokenInterface, UserInterface} from '../../models';\r\n\r\nclass AuthService {\r\n  createTokenPair(tokenObject: Partial<AccessTokenInterface>): Promise<AccessTokenInterface> {\r\n    const tokensToCreate = new AccessTokenModel(tokenObject);\r\n\r\n    return tokensToCreate.save();\r\n  }\r\n\r\n  async findUserByToken(findObject: {accessToken?: string, refreshToken?: string}): Promise<UserInterface | null> {\r\n    const tokenAndUser = await AccessTokenModel\r\n      .findOne(findObject)\r\n      .populate('userId')\r\n      .select({userId: 1, _id: 0}) as any;\r\n\r\n    return tokenAndUser?.userId?.toJSON();\r\n  }\r\n\r\n  removeToken(removeObject: {accessToken?: string, refreshToken?: string}): Promise<AccessTokenInterface | null> {\r\n    return AccessTokenModel.findOneAndDelete(removeObject) as any;\r\n  }\r\n}\r\n\r\nexport const authService = new AuthService();\r\n"]}